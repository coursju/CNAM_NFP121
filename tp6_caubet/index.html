<html>
<head>
    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
    <title>NFP121 - TP6</title>
    <style type="text/css">
        body {
            background: #E5DED6;
            background-color: #fff;
            color: #333333;
            font-size: 14px;
            font-family: Verdana, Arial;
        }

        table {
            font-size: 20px;
            border-color: #808080;
            border-style: solid;
            border-width: 1px;
        }

        h2 {
            color: #C1002A;
            font-family: Verdana, Arial;
            font-size: 30px;
            font-weight: bold;
        }

        h3 {
            color: #C1002A;
            font-family: Verdana, Arial;
            font-size: 20px;
            font-weight: bold;
        }

        hr {
            margin: 15px 0 15px 0;
        }

		applet {
			margin: 10px 0px 25px 250px;
			border-width: 1px;
			border-style: solid;
			border-color: #777777;
		}
    </style>

</head>
<body>
    <h2 style="text-align: center">NFP 121 - TP6</h2>
    <h2 style="text-align: center">WhileL et les Visiteurs</h2>
    <br />
    <hr>
    <br />
    <table>
        <tr>
            <td>Nom
            </td>
            <td>: CAUBET
            </td>
        </tr>
        <tr>
            <td>Prenom
            </td>
            <td>: Julien
            </td>
        </tr>
        <tr>
            <td>Matricule
            </td>
            <td>: FOD_motdepasse1
            </td>
        </tr>
    </table>

	<br />
    <hr />
    <h3>Question 1</h3>
    <p>Les classes VisiteurEvaluation, VisiteurPostfixe et TestsACompleter</p>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question1;

<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurEvaluation <span style='font-weight:bold;color:#7B0052;'>extends</span> VisiteurParDefaut&lt;Integer&gt; <span style='font-weight:bold;color:#D3171B'>{</span>

    <span style='font-weight:bold;color:#7B0052;'>private</span> Contexte c;

    <span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurEvaluation(Contexte c) <span style='font-weight:bold;color:#D3171B'>{</span>
        this.c = c;
    <span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Integer visite(Constante c) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> c.valeur();
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Integer visite(Variable v) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> c.lire(v.nom());
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Integer visite(Division d) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> d.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) / d.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Integer visite(Addition a) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> a.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + a.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Integer visite(Multiplication m) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> m.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) * m.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Integer visite(Soustraction s) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> s.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) - s.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> Contexte contexte() <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> c;
	<span style='font-weight:bold;color:#D3171B'>}</span>

<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <br>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question1;

    <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurPostfixe <span style='font-weight:bold;color:#7B0052;'>extends</span> VisiteurParDefaut&lt;String&gt; <span style='font-weight:bold;color:#D3171B'>{</span>

        <span style='font-weight:bold;color:#7B0052;'>private</span> Contexte c;

        <span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurPostfixe(Contexte c) <span style='font-weight:bold;color:#D3171B'>{</span>
            this.c = c;
        <span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Constante c) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> Integer.toString(c.valeur());
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Variable v) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> v.nom();
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Division d) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span> + d.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + <span style='color:#2A00FF'>","</span> + d.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)
    				+ <span style='color:#2A00FF'>")/"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Addition a) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span> + a.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + <span style='color:#2A00FF'>","</span> + a.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)
    				+ <span style='color:#2A00FF'>")+"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Multiplication m) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span> + m.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + <span style='color:#2A00FF'>","</span> + m.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)
    				+ <span style='color:#2A00FF'>")*"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Soustraction s) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span> + s.op1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + <span style='color:#2A00FF'>","</span> + s.op2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)
    				+ <span style='color:#2A00FF'>")-"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> Contexte contexte() <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> c;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question1;

    <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> TestsACompleter <span style='font-weight:bold;color:#7B0052;'>extends</span> junit.framework.TestCase<span style='font-weight:bold;color:#D3171B'>{</span>
        <span style='font-weight:bold;color:#7B0052;'>private</span> Memoire m;
        <span style='font-weight:bold;color:#7B0052;'>private</span> Variable i,j,k,l;
        <span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpression&lt;Integer&gt; ve;
        <span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpression&lt;String&gt;  vp,vi;

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> setUp()<span style='font-weight:bold;color:#D3171B'>{</span>
            m  = <span style='font-weight:bold;color:#7B0052;'>new</span> Memoire();
            i  = <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m,<span style='color:#2A00FF'>"i"</span>,3);
            j = <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m,<span style='color:#2A00FF'>"j"</span>,5);
            k = <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m,<span style='color:#2A00FF'>"k"</span>,7);
            l = <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m,<span style='color:#2A00FF'>"l"</span>,9);
            ve = <span style='font-weight:bold;color:#7B0052;'>new</span> VisiteurEvaluation( m);
            vi = <span style='font-weight:bold;color:#7B0052;'>new</span> VisiteurInfixe( m);
            vp = <span style='font-weight:bold;color:#7B0052;'>new</span> VisiteurPostfixe( m);
            assertNotNull(i);assertNotNull(j);
            assertNotNull(ve);assertNotNull(vp);assertNotNull(vi);
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testUneAddition()<span style='font-weight:bold;color:#D3171B'>{</span>
            Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(2));
            assertEquals(<span style='color:#2A00FF'>" 3+2 != 5 ?, curieux "</span>,5,expr.accepter(ve).intValue());
            assertEquals(m.lire(<span style='color:#2A00FF'>"j"</span>),new Integer(5));
            assertEquals(m.lire(<span style='color:#2A00FF'>"i"</span>),new Integer(3));
            expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(j,i);
            assertEquals(<span style='font-weight:bold;color:#7B0052;'>new</span> Integer(8),expr.accepter(ve));
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testMultiplication()<span style='font-weight:bold;color:#D3171B'>{</span>
            Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Multiplication(j, i);
            assertEquals(<span style='color:#2A00FF'>" 5x3 != 15 ?, curieux"</span>, 15, expr.accepter(ve).intValue());
            expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Multiplication(expr, <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8));
            assertEquals(<span style='color:#2A00FF'>" 15 * 8 != 120 ?, curieux"</span>, 120, expr.accepter(ve).intValue());
            expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Multiplication(k, <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8));
            assertEquals(<span style='color:#2A00FF'>" 7 * 8 != 56 ?, curieux"</span>, 56, expr.accepter(ve).intValue());
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testSoustraction()<span style='font-weight:bold;color:#D3171B'>{</span>
            Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(j, i);
            assertEquals(<span style='color:#2A00FF'>" 5-3 != 2 ?, curieux"</span>, 2, expr.accepter(ve).intValue());
            expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(expr, <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8));
            assertEquals(<span style='color:#2A00FF'>" 2 - 8 != -6 ?, curieux"</span>, -6, expr.accepter(ve).intValue());
            expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(k, <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8));
            assertEquals(<span style='color:#2A00FF'>" 7 - 8 != -1 ?, curieux"</span>, -1, expr.accepter(ve).intValue());
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testDivision()<span style='font-weight:bold;color:#D3171B'>{</span>
            Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Division(j, i);
            assertEquals(<span style='color:#2A00FF'>" 5/3 != 1 ?, curieux"</span>, 1, expr.accepter(ve).intValue());
            <span style='font-weight:bold;color:#7B0052;'>try</span><span style='font-weight:bold;color:#D3171B'>{</span>
                <span style='font-weight:bold;color:#7B0052;'>new</span> Division(l,new Constante(0)).accepter(ve);
                fail(<span style='color:#2A00FF'>"division par zéro ? possible "</span>);
            <span style='font-weight:bold;color:#D3171B'>}</span><span style='font-weight:bold;color:#7B0052;'>catch</span>(ArithmeticException ae)<span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#D3171B'>}</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testVisiteurInfixe()<span style='font-weight:bold;color:#D3171B'>{</span>

            <span style='font-weight:bold;color:#7B0052;'>try</span><span style='font-weight:bold;color:#D3171B'>{</span>
                Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(2));
                assertEquals(<span style='color:#2A00FF'>"(3 + 2)"</span>, expr.accepter(vi));
                expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(expr, <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(2));
                assertEquals(<span style='color:#2A00FF'>"((3 + 2) + 2)"</span>, expr.accepter(vi));
                assertEquals(<span style='color:#2A00FF'>"{i=3, j=5, k=7, l=9}"</span>, m.toString());
                expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(expr, expr);
                Expression add = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3));
                Expression sub = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(2));
                Expression mul = <span style='font-weight:bold;color:#7B0052;'>new</span> Multiplication(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8));
                Expression div = <span style='font-weight:bold;color:#7B0052;'>new</span> Division(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(4));
                assertEquals(<span style='color:#2A00FF'>"(5 + 3)"</span>, add.accepter(vi));
                assertEquals(<span style='color:#2A00FF'>"(5 - 2)"</span>, sub.accepter(vi));
                assertEquals(<span style='color:#2A00FF'>"(5 * 8)"</span>, mul.accepter(vi));
                assertEquals(<span style='color:#2A00FF'>"(5 / 4)"</span>, div.accepter(vi));
                <span style='color:#3F7F5F'>//System.out.println(expr.accepter(vi));
    </span>            assertEquals(<span style='color:#2A00FF'>"(((3 + 2) + 2) - ((3 + 2) + 2))"</span>, expr.accepter(vi));
            <span style='font-weight:bold;color:#D3171B'>}</span><span style='font-weight:bold;color:#7B0052;'>catch</span>(Exception e)<span style='font-weight:bold;color:#D3171B'>{</span>
                fail(<span style='color:#2A00FF'>" exception inattendue ???"</span> + e.getClass().getName() + e.getMessage());
            <span style='font-weight:bold;color:#D3171B'>}</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testVisiteurPostfixe()<span style='font-weight:bold;color:#D3171B'>{</span>

            <span style='font-weight:bold;color:#7B0052;'>try</span><span style='font-weight:bold;color:#D3171B'>{</span>
                Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(2));
                assertEquals(<span style='color:#2A00FF'>"(3,2)+"</span>, expr.accepter(vp));
                expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(expr, <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(2));
                assertEquals(<span style='color:#2A00FF'>"((3,2)+,2)+"</span>, expr.accepter(vp));
                assertEquals(<span style='color:#2A00FF'>"{i=3, j=5, k=7, l=9}"</span>,m.toString());
                expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(expr, expr);
                assertEquals(<span style='color:#2A00FF'>"(((3,2)+,2)+,((3,2)+,2)+)-"</span>, expr.accepter(vp));
                Expression add = <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(14), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5));
                Expression sub = <span style='font-weight:bold;color:#7B0052;'>new</span> Soustraction(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5));
                Expression mul = <span style='font-weight:bold;color:#7B0052;'>new</span> Multiplication(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), k);
                Expression div = <span style='font-weight:bold;color:#7B0052;'>new</span> Division(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), l);
                assertEquals(<span style='color:#2A00FF'>"(14,5)+"</span>, add.accepter(vp));
                assertEquals(<span style='color:#2A00FF'>"(8,5)-"</span>, sub.accepter(vp));
                assertEquals(<span style='color:#2A00FF'>"(5,k)*"</span>, mul.accepter(vp));
                assertEquals(<span style='color:#2A00FF'>"(5,l)/"</span>, div.accepter(vp));
            <span style='font-weight:bold;color:#D3171B'>}</span><span style='font-weight:bold;color:#7B0052;'>catch</span>(Exception e)<span style='font-weight:bold;color:#D3171B'>{</span>
                fail(<span style='color:#2A00FF'>" exception inattendue ???"</span> + e.getClass().getName() + e.getMessage());
            <span style='font-weight:bold;color:#D3171B'>}</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testConstante() <span style='font-weight:bold;color:#D3171B'>{</span>
            Expression expr = <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5);
            assertEquals(m.lire(<span style='color:#2A00FF'>"j"</span>), expr.accepter(ve));<span style='color:#3F7F5F'>//.intValue());
    </span>    <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testVariable() <span style='font-weight:bold;color:#D3171B'>{</span>
            assertEquals(9, l.accepter(ve).intValue());
        <span style='font-weight:bold;color:#D3171B'>}</span>
    <span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br>
    <hr />
    <h3>Question 2.1</h3>
    <p>La classe VisiteurBoolTojava</p>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question2;

<span style='font-weight:bold;color:#7B0052;'>import</span> question1.*;

<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurBoolToJava <span style='font-weight:bold;color:#7B0052;'>extends</span> VisiteurExpressionBooleenne&lt;String&gt; <span style='font-weight:bold;color:#D3171B'>{</span>

    <span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpression&lt;String&gt; ve;

    <span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurBoolToJava(VisiteurExpression&lt;String&gt; ve) <span style='font-weight:bold;color:#D3171B'>{</span>
        this.ve = ve;
    <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Vrai v) <span style='font-weight:bold;color:#D3171B'>{</span>
        <span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"true"</span>;
    <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Faux f) <span style='font-weight:bold;color:#D3171B'>{</span>
        <span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"false"</span>;
    <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Non n) <span style='font-weight:bold;color:#D3171B'>{</span>
        <span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"!("</span> +n.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+ <span style='color:#2A00FF'>")"</span>;
    <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Ou ou) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span>+ou.bop1.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+<span style='color:#2A00FF'>" || "</span>+ou.bop2.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+<span style='color:#2A00FF'>")"</span>;
    <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Et et) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span>+et.bop1.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+<span style='color:#2A00FF'>" && "</span>+et.bop2.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+<span style='color:#2A00FF'>")"</span>;
    <span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Sup sup) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span>+sup.op1.accepter(ve)+<span style='color:#2A00FF'>" &gt; "</span>+sup.op2.accepter(ve)+<span style='color:#2A00FF'>")"</span>;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Egal eg) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span>+eg.op1.accepter(ve)+<span style='color:#2A00FF'>" == "</span>+eg.op2.accepter(ve)+<span style='color:#2A00FF'>")"</span>;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Inf inf) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"("</span>+inf.op1.accepter(ve)+<span style='color:#2A00FF'>" &lt; "</span>+inf.op2.accepter(ve)+<span style='color:#2A00FF'>")"</span>;
	<span style='font-weight:bold;color:#D3171B'>}</span>

<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 2.2</h3>
    <p>Les classes VisiteurBoolEvaluation et TestsDuVisiteurBoolEvaluation</p>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question2;

    <span style='font-weight:bold;color:#7B0052;'>import</span> question1.VisiteurExpression;

    <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurBoolEvaluation <span style='font-weight:bold;color:#7B0052;'>extends</span> VisiteurExpressionBooleenne&lt;Boolean&gt; <span style='font-weight:bold;color:#D3171B'>{</span>

        <span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpression&lt;Integer&gt; ve;

        <span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurBoolEvaluation(VisiteurExpression&lt;Integer&gt; ve) <span style='font-weight:bold;color:#D3171B'>{</span>
            this.ve = ve;

        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Vrai v) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>; <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Faux f) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>; <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Non n) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> !n.bop().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>); <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Ou ou) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> ou.bop1.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) || ou.bop2.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>); <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Et et) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> et.bop1.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) && et.bop2.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>); <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Sup sup) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> sup.op1.accepter(ve) &gt; sup.op2.accepter(ve); <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Egal eg) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> eg.op1.accepter(ve) == eg.op2.accepter(ve); <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> Boolean visite(Inf inf) <span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> inf.op1.accepter(ve) &lt; inf.op2.accepter(ve); <span style='color:#3F7F5F'>/* a completer */</span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question2;

    <span style='font-weight:bold;color:#7B0052;'>import</span> question1.*;

    <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> TestsDuVisiteurBoolEvaluation <span style='font-weight:bold;color:#7B0052;'>extends</span> junit.framework.TestCase <span style='font-weight:bold;color:#D3171B'>{</span>

        <span style='font-weight:bold;color:#7B0052;'>protected</span> Contexte m;
        <span style='font-weight:bold;color:#7B0052;'>protected</span> VisiteurExpressionBooleenne&lt;Boolean&gt; veb;

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> setUp() <span style='font-weight:bold;color:#D3171B'>{</span>
            m = <span style='font-weight:bold;color:#7B0052;'>new</span> Memoire();
            veb = <span style='font-weight:bold;color:#7B0052;'>new</span> VisiteurBoolEvaluation(<span style='font-weight:bold;color:#7B0052;'>new</span> VisiteurEvaluation(m));
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>void</span> testVisiteurBoolEvaluation() <span style='font-weight:bold;color:#D3171B'>{</span>
            assertTrue(<span style='font-weight:bold;color:#7B0052;'>new</span> Vrai().accepter(veb));
            assertFalse(<span style='font-weight:bold;color:#7B0052;'>new</span> Faux().accepter(veb));
            assertTrue(<span style='font-weight:bold;color:#7B0052;'>new</span> Sup(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3)).accepter(veb));

            <span style='color:#3F7F5F'>// etc ...
    </span>        assertTrue(<span style='font-weight:bold;color:#7B0052;'>new</span> Egal(<span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3)), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(8)).accepter(veb));
                    assertTrue(<span style='color:#2A00FF'>"(i &lt; j)"</span>, <span style='font-weight:bold;color:#7B0052;'>new</span> Inf(<span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"i"</span>, 3), <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"j"</span>, 5)).accepter(veb));
                    assertTrue(<span style='font-weight:bold;color:#7B0052;'>new</span> Inf(<span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"i"</span>, 1),
                               <span style='font-weight:bold;color:#7B0052;'>new</span> Addition(<span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"j"</span>, 2), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(1))).accepter(veb));
                    assertTrue(<span style='font-weight:bold;color:#7B0052;'>new</span> Ou(<span style='font-weight:bold;color:#7B0052;'>new</span> Sup(<span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"i"</span>, 8), <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"j"</span>, 1)),
                               <span style='font-weight:bold;color:#7B0052;'>new</span> Inf(<span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"i"</span>, 1), <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"j"</span>, 8))).accepter(veb));
                    assertTrue(<span style='font-weight:bold;color:#7B0052;'>new</span> Et(<span style='font-weight:bold;color:#7B0052;'>new</span> Sup(<span style='font-weight:bold;color:#7B0052;'>new</span> Constante(5), <span style='font-weight:bold;color:#7B0052;'>new</span> Constante(3)),
                               <span style='font-weight:bold;color:#7B0052;'>new</span> Inf(<span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"i"</span>,2), <span style='font-weight:bold;color:#7B0052;'>new</span> Variable(m, <span style='color:#2A00FF'>"j"</span>,6))).accepter(veb));
        <span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 3.1</h3>
    <p>Les classes VisiteurInstEvaluation et VisiteurInstTojava</p>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question3;

    <span style='font-weight:bold;color:#7B0052;'>import</span> question1.*;
    <span style='font-weight:bold;color:#7B0052;'>import</span> question2.*;
    <span style='color:#3F5FBF'>/**
     * Visisteur d'instruction, chaque classe concrète possède une implémentation de la visite
     *
     */</span>
    <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurInstEvaluation <span style='font-weight:bold;color:#7B0052;'>extends</span> VisiteurInstruction&lt;Contexte&gt;<span style='font-weight:bold;color:#D3171B'>{</span>

        <span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpression&lt;Integer&gt; vi;
        <span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpressionBooleenne&lt;Boolean&gt; vb;

        <span style='color:#3F5FBF'>/** Création d'un visiteur d'instructions
         * @param vi le visiteur d'expressions arithmétiques
         * @param vb le visiteur d'expression booléennes
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurInstEvaluation(VisiteurExpression&lt;Integer&gt; vi, VisiteurExpressionBooleenne&lt;Boolean&gt; vb)<span style='font-weight:bold;color:#D3171B'>{</span>
            this.vi = vi;
            this.vb = vb;
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='color:#3F5FBF'>/** obtention du contexte, ici celui du visiteur d'expression arithmétiques
         * @return le contexte ici de vi(le visiteur d'expression)
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte contexte()<span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> this.vi.contexte();
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='color:#3F5FBF'>/** Visite d'une instance de la classe Affectation.
         *
         * l'affectation, X = Exp, Exp est une expression arithmétique &lt;br&gt;
         * &lt;code&gt;
         *
         *     M,Exp -interprete-&gt; N       &lt;br&gt;
         * ________________________________&lt;br&gt;
         * M, X = Exp -interprete-&gt; M[X]=N &lt;br&gt;
         * &lt;/code&gt;
         *
         * @param a  une affectation
         * @return la mémoire résultante
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(Affectation a)<span style='font-weight:bold;color:#D3171B'>{</span>
            this.contexte().ecrire(a.v().nom(),a.exp().accepter(vi));

            <span style='font-weight:bold;color:#7B0052;'>return</span> this.contexte(); <span style='color:#3F7F5F'>// à compléter en retournant le contexte modifié;
    </span>    <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='color:#3F5FBF'>/** Visite d'une séquence seq(I1,I2) &lt;br&gt;
         * &lt;code&gt;
         *
         *    M,I1 -interprete-&gt; M1        &lt;br&gt;
         *    M1,I2 -interprete-&gt; M2       &lt;br&gt;
         * ________________________________&lt;br&gt;
         *    M,seq(I,I2)-interprete-&gt; M2  &lt;br&gt;
         *&lt;/code&gt;
         *
         * @param seq  une séquence
         * @return la mémoire résultante
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(Sequence seq)<span style='font-weight:bold;color:#D3171B'>{</span>
            seq.i1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
            seq.i2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
            <span style='font-weight:bold;color:#7B0052;'>return</span> this.vi.contexte();
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='color:#3F5FBF'>/** Visiste d'une sélection si (Bexp) alors I1 sinon I2 fsi &lt;br&gt;
         * ou si (Bexp) alors I1 fsi &lt;br&gt;
         *
         * &lt;code&gt;
         *
         *      M,Bexp-interprete-&gt; vrai             &lt;br&gt;
         *      M,I1 -interprete-&gt; M1                &lt;br&gt;
         * _________________________________________ &lt;br&gt;
         * M,si(Bexp)alorsI1 sinon I2-interprete-&gt; M1&lt;br&gt;
         *
         *      M,Bexp -interprete-&gt; faux            &lt;br&gt;
         *      M,I2 -interprete-&gt; M2                &lt;br&gt;
         * __________________________________________&lt;br&gt;
         * M,si(Bexp)alorsI1 sinon I2-interprete-&gt;M2 &lt;br&gt;
         * &lt;/code&gt;
         *
         * @param sel  une sélection
         * @return la mémoire résultante
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(Selection sel)<span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>if</span> (sel.cond().accepter(vb)) <span style='font-weight:bold;color:#D3171B'>{</span>
                sel.i1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
            <span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#7B0052;'>if</span> (sel.i2 != <span style='font-weight:bold;color:#7B0052;'>null</span>)<span style='font-weight:bold;color:#D3171B'>{</span>
                sel.i2.accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
            <span style='font-weight:bold;color:#D3171B'>}</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> this.contexte(); <span style='color:#3F7F5F'>// à compléter en retournant le contexte modifié;
    </span>
        <span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='color:#3F5FBF'>/** La boucle tantque(Bexp,I1)&lt;br&gt;
         * &lt;code&gt;
         *
         *     M,Bexp -interprete-&gt;faux              &lt;br&gt;
         * _________________________________________ &lt;br&gt;
         * M,tantque(Bexp) faire I1-interprete-&gt; M   &lt;br&gt;
         * &lt;br&gt;
         * M,Bexp -interprete-&gt; vrai                          &lt;br&gt;
         * M,seq(I1,tantque(Bexp)faire I1)-interprete-&gt; M1    &lt;br&gt;
         * ___________________________________________________&lt;br&gt;
         * M,tantque(Bexp)faire I1-interprete-&gt; M1
         * &lt;/code&gt;
         *
         * @param tq  une itération de la classe tantque
         * @return la mémoire résultante
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(TantQue tq)<span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>if</span> (tq.cond().accepter(vb)) <span style='font-weight:bold;color:#D3171B'>{</span>
                <span style='font-weight:bold;color:#7B0052;'>new</span> Sequence(tq.i1(), <span style='font-weight:bold;color:#7B0052;'>new</span> TantQue(tq.cond(), tq.i1())).accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);
            <span style='font-weight:bold;color:#D3171B'>}</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> this.contexte();
        <span style='font-weight:bold;color:#D3171B'>}</span>


        <span style='color:#3F5FBF'>/** La boucle pour(init,Bexp,inc)I1&lt;br&gt;
         * &lt;code&gt;
         * M,seq(init,tantque(Bexp)seq(I1,inc))-visite-&gt;faux &lt;br&gt;
         * _____________________________________________________ &lt;br&gt;
         * M,pour(init,Bexp,inc) faire I1-visite-&gt; M         &lt;br&gt;
         * &lt;/code&gt;
         *
         * @param pour  une itération de la classe Pour
         * @return la mémoire résultante
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(Pour pour)<span style='font-weight:bold;color:#D3171B'>{</span>
            <span style='font-weight:bold;color:#7B0052;'>new</span> Sequence(pour.init(),new TantQue(pour.cond(),new Sequence( pour.i1(), pour.inc()))).accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>);

            <span style='font-weight:bold;color:#7B0052;'>return</span> this.contexte(); <span style='color:#3F7F5F'>// à compléter en retournant le contexte modifié;
    </span>    <span style='font-weight:bold;color:#D3171B'>}</span>


        <span style='color:#3F5FBF'>/** L'affichage&lt;br&gt;
         * &lt;code&gt;
         *
         *    M,Exp-visite-&gt; n                              &lt;br&gt;
         * ________________________________System.out.print(n)&lt;br&gt;
         * M,afficher(Exp)-visite-&gt; M
         * &lt;/code&gt;
         *
         * @param a  une instruction d'affichage d'une expression arithmétique
         * @return la mémoire intacte
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(Afficher a)<span style='font-weight:bold;color:#D3171B'>{</span>
            System.out.println(a.exp().accepter(this.vi));
            <span style='font-weight:bold;color:#7B0052;'>return</span> this.vi.contexte();
        <span style='font-weight:bold;color:#D3171B'>}</span>


        <span style='color:#3F5FBF'>/** Une assertion,
         * si celle-ci échoue une exception est levée,
         * emploi de la clause &lt;a href=http://java.sun.com/j2se/1.5.0/docs/guide/language/assert.html&gt; assert&lt;/a&gt; Expr : "un Message";
         *
         * @param a  une assertion
         * @return la mémoire intacte
         * @throws une exception AssertionError
         */</span>
        <span style='font-weight:bold;color:#7B0052;'>public</span> Contexte visite(Assertion a) <span style='font-weight:bold;color:#D3171B'>{</span>
            String mess = <span style='color:#2A00FF'>"assertion erreur"</span>;
            <span style='font-weight:bold;color:#7B0052;'>if</span>(a.message() != <span style='font-weight:bold;color:#7B0052;'>null</span>)<span style='font-weight:bold;color:#D3171B'>{</span>mess = a.message();<span style='font-weight:bold;color:#D3171B'>}</span>
            <span style='font-weight:bold;color:#7B0052;'>if</span>(!a.cond().accepter(vb))<span style='font-weight:bold;color:#D3171B'>{</span>
                <span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> AssertionError(mess);
            <span style='font-weight:bold;color:#D3171B'>}</span>
            <span style='font-weight:bold;color:#7B0052;'>return</span> this.contexte(); <span style='color:#3F7F5F'>// à compléter en retournant le contexte modifié;
    </span>    <span style='font-weight:bold;color:#D3171B'>}</span>



    <span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br>

    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question3;

    <span style='font-weight:bold;color:#7B0052;'>import</span> java.io.*;

    <span style='font-weight:bold;color:#7B0052;'>import</span> question1.*;
    <span style='font-weight:bold;color:#7B0052;'>import</span> question2.*;

    <span style='color:#3F5FBF'>/**
     *
     */</span>
    <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurInstToJava <span style='font-weight:bold;color:#7B0052;'>extends</span> VisiteurInstruction&lt;String&gt; <span style='font-weight:bold;color:#D3171B'>{</span>

    	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>final</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>int</span> TAB = 2;
    	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>final</span> String lineSeparator = System.getProperties().getProperty(<span style='color:#2A00FF'>"line.separator"</span>);

    	<span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpression&lt;String&gt; vi;
    	<span style='font-weight:bold;color:#7B0052;'>private</span> VisiteurExpressionBooleenne&lt;String&gt; vb;

    	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>int</span> tabulations;

    	<span style='color:#3F5FBF'>/**
    	 * Création d'un visiteur d'instructions
    	 *
    	 * @param vi
    	 *            le visiteur d'expressions arithmétiques
    	 * @param vb
    	 *            le visiteur d'expression booléennes
    	 * @param tabulations
    	 *            tabulations initiales
    	 */</span>
    	<span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurInstToJava(VisiteurExpression&lt;String&gt; vi, VisiteurExpressionBooleenne&lt;String&gt; vb, <span style='font-weight:bold;color:#7B0052;'>int</span> tabulations) <span style='font-weight:bold;color:#D3171B'>{</span>
    		this.vi = vi;
    		this.vb = vb;
    		this.tabulations = tabulations;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='color:#3F5FBF'>/**
    	 * Création d'un visiteur d'instructions
    	 *
    	 * @param vi
    	 *            le visiteur d'expressions arithmétiques
    	 * @param vb
    	 *            le visiteur d'expression booléennes
    	 */</span>
    	<span style='font-weight:bold;color:#7B0052;'>public</span> VisiteurInstToJava(VisiteurExpression&lt;String&gt; vi, VisiteurExpressionBooleenne&lt;String&gt; vb) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>this</span>(vi, vb, 0);
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='color:#3F5FBF'>/**
    	 * obtention du contexte, ici celui du visiteur d'expression arithmétiques
    	 *
    	 * @return le contexte ici de vi(le visiteur d'expression)
    	 */</span>
    	<span style='font-weight:bold;color:#7B0052;'>public</span> Contexte contexte() <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> this.vi.contexte();
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='color:#3F5FBF'>/**
    	 * Visite d'une instance de la classe Affectation.
    	 *
    	 *
    	 * @param a
    	 *            une affectation
    	 * @return a := exp
    	 */</span>
    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Affectation a) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> a.v().accepter(this.vi) + <span style='color:#2A00FF'>"="</span> + a.exp().accepter(this.vi); <span style='color:#3F7F5F'>//*
    </span>	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='color:#3F5FBF'>/**
    	 * Visiste d'une séquence seq(I1,I2) &lt;br&gt;
    	 *
    	 * @param seq
    	 *            une séquence
    	 * @return i1;i2
    	 */</span>
    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Sequence seq) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> seq.i1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)   + <span style='color:#2A00FF'>" ;\n "</span> + seq.i2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+<span style='color:#2A00FF'>" ; "</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Selection sel) <span style='font-weight:bold;color:#D3171B'>{</span>
    		String str = <span style='color:#2A00FF'>"if("</span> + sel.cond().accepter(this.vb) + <span style='color:#2A00FF'>" ){\n "</span> + sel.i1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+ <span style='color:#2A00FF'>" \n}\n "</span> ;
    		<span style='font-weight:bold;color:#7B0052;'>if</span> (sel.i2() != <span style='font-weight:bold;color:#7B0052;'>null</span>) str = str + <span style='color:#2A00FF'>" else{\n "</span> + sel.i2().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)+ <span style='color:#2A00FF'>" \n} "</span> ;

    		<span style='font-weight:bold;color:#7B0052;'>return</span> str ;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(TantQue tq) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"while("</span> + tq.cond().accepter(this.vb) + <span style='color:#2A00FF'>" ){\n "</span> + tq.i1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + <span style='color:#2A00FF'>" ;\n}"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Pour pour) <span style='font-weight:bold;color:#D3171B'>{</span>
                    <span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"for("</span> + pour.init().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) +<span style='color:#2A00FF'>" ; "</span> + pour.cond().accepter(this.vb)
    				+<span style='color:#2A00FF'>" ; "</span> + pour.inc().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>) + <span style='color:#2A00FF'>"){\n "</span> + pour.i1().accepter(<span style='font-weight:bold;color:#7B0052;'>this</span>)
    				+ <span style='color:#2A00FF'>" ;\n}"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Afficher a) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"System.out.println("</span> + a.exp().accepter(this.vi) + <span style='color:#2A00FF'>");\n"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>public</span> String visite(Assertion a) <span style='font-weight:bold;color:#D3171B'>{</span>
    		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='color:#2A00FF'>"assert"</span> + a.cond().accepter(this.vb) +<span style='color:#2A00FF'>"\n"</span>;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    	<span style='font-weight:bold;color:#7B0052;'>private</span> String tab(<span style='font-weight:bold;color:#7B0052;'>int</span> n) <span style='font-weight:bold;color:#D3171B'>{</span>
    		String str = <span style='font-weight:bold;color:#7B0052;'>new</span> String();

    		str = str + lineSeparator;
    		<span style='font-weight:bold;color:#7B0052;'>for</span> (<span style='font-weight:bold;color:#7B0052;'>int</span> i = 0; i &lt; this.tabulations + n; i++) <span style='font-weight:bold;color:#D3171B'>{</span>
    			str = str + <span style='color:#2A00FF'>" "</span>;
    		<span style='font-weight:bold;color:#D3171B'>}</span>
    		this.tabulations += n;
    		<span style='font-weight:bold;color:#7B0052;'>return</span> str;
    	<span style='font-weight:bold;color:#D3171B'>}</span>

    <span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 3.2</h3>
<p>Les classes Pour et VisiteurInstruction<T>, les methodes "visiteur" sont visibles sur le code au dessus</p>

  <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question3;

  <span style='font-weight:bold;color:#7B0052;'>import</span> question2.*;

  <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> Pour <span style='font-weight:bold;color:#7B0052;'>extends</span> Iteration <span style='font-weight:bold;color:#D3171B'>{</span>

  	<span style='font-weight:bold;color:#7B0052;'>private</span> Instruction init, inc;

  	<span style='font-weight:bold;color:#7B0052;'>public</span> Pour (Instruction init, ExpressionBooleenne cond, Instruction i1,
  			Instruction inc) <span style='font-weight:bold;color:#D3171B'>{</span>
  		<span style='font-weight:bold;color:#7B0052;'>super</span>(cond, i1);
  		this.init = init;
  		this.inc = inc;
  	<span style='font-weight:bold;color:#D3171B'>}</span>

  	<span style='font-weight:bold;color:#7B0052;'>public</span> &lt;T&gt; T accepter(VisiteurInstruction&lt;T&gt; vi) <span style='font-weight:bold;color:#D3171B'>{</span>
  		<span style='font-weight:bold;color:#7B0052;'>return</span> vi.visite(<span style='font-weight:bold;color:#7B0052;'>this</span>);
  	<span style='font-weight:bold;color:#D3171B'>}</span>

  	<span style='font-weight:bold;color:#7B0052;'>public</span> Instruction init() <span style='font-weight:bold;color:#D3171B'>{</span>
  		<span style='font-weight:bold;color:#7B0052;'>return</span> init;
  	<span style='font-weight:bold;color:#D3171B'>}</span>

  	<span style='font-weight:bold;color:#7B0052;'>public</span> Instruction inc() <span style='font-weight:bold;color:#D3171B'>{</span>
  		<span style='font-weight:bold;color:#7B0052;'>return</span> inc;
  	<span style='font-weight:bold;color:#D3171B'>}</span>

  <span style='font-weight:bold;color:#D3171B'>}</span></pre>

<br>

<pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>package</span> question3;

<span style='font-weight:bold;color:#7B0052;'>import</span> question1.Contexte;

<span style='color:#3F7F5F'>/* Classe abstraite des Visiteurs,
 * Une méthode par noeud concret du composite
 */</span>
<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> <span style='font-weight:bold;color:#7B0052;'>class</span> VisiteurInstruction&lt;T&gt; <span style='font-weight:bold;color:#D3171B'>{</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(Affectation aff);
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(Sequence seq);
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(Selection sel);

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(TantQue tq);
	<span style='color:#3F7F5F'>// ajouter la visite de l'instruction Pour
</span>	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(Pour pour);

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(Afficher a);
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> T visite(Assertion a);

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>abstract</span> Contexte contexte();

<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 3.3</h3>
<p>Le resultat de tests de Jnews</p>
 <img src="q3-3- bon_fonct_test.png" alt="tests au vert" height="380" width="500">
    <br />
    <hr />
        <h3>Conclusion, biliographie et remarques :</h3>
        <i style="font-size:12px;">... Je ne comprends pas bien l' interet de la question 3 de soumettre au petit bonheur la chance le placement des parentheses et point virgules. Il m' a fallu pas mal de temps et de tests pour realiser qu' un code java exacte n' etait pas attendu. Il est clairement impossible de finir ce TP sans utiliser Jnews pour aiguiller. J ai bien pense que je n allais pas etre capable de rendre le TP dans les temps ce coup ci. J espere que la monte en puissance des TP va s arreter la car je ne suis pas sur de pouvoir suivre.</i>
</body>
</html>
